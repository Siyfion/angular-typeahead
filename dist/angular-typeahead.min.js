!function(a,b){"function"==typeof define&&define.amd?define([],function(){return b()}):"object"==typeof exports?module.exports=b():b()}(this,function(){"use strict";angular.module("siyfion.sfTypeahead",[]).value("$typeahead",function(a){a.typeahead.apply(a,Array.prototype.slice.call(arguments,1))}).directive("sfTypeahead",["$typeahead",function(a){return{restrict:"AC",require:"ngModel",scope:{datasets:"=",options:"=",allowCustom:"="},link:function(b,c,d,e){function f(){p=n?b.$watchCollection("datasets",g):b.$watch("datasets",g)}function g(a,b){if(!angular.equals(a,b)){var c=n;h(),n!==c&&(p(),f())}}function h(){if(null==b.datasets)throw new Error("The datasets parameter is mandatory!");if(l=b.options||{},n=angular.isArray(b.datasets),m=n?b.datasets:[b.datasets],o){var d=c.val();a(c,"destroy"),a(c,l,m),e.$setViewValue(d)}else a(c,l,m),b.$watch("options",h),o=!0}function i(a){for(var b in m){var c=m[b],d=c.displayKey||"value",e=(angular.isFunction(d)?d(a):a[d])||"";return e}}function j(){return void 0===b.allowCustom||!!b.allowCustom}function k(a){b.$apply(function(){e.$setViewValue(a)})}var l,m,n,o=!1,p=null;h(),f(),e.$parsers.push(function(a){return angular.isObject(e.$modelValue)&&a===i(e.$modelValue)?e.$modelValue:j()||"string"!=typeof a?a:e.$modelValue}),e.$formatters.push(function(b){return angular.isObject(b)&&(b=i(b)),b?a(c,"val",b):a(c,"val",""),b}),c.bind("typeahead:selected",function(a,c,d){k(c),b.$emit("typeahead:selected",c,d)}),c.bind("typeahead:autocompleted",function(a,c,d){k(c),b.$emit("typeahead:autocompleted",c,d)}),c.bind("typeahead:opened",function(){b.$emit("typeahead:opened")}),c.bind("typeahead:closed",function(){b.$emit("typeahead:closed")}),c.bind("typeahead:asyncrequest",function(){b.$emit("typeahead:asyncrequest")}),c.bind("typeahead:asynccancel",function(){b.$emit("typeahead:asynccancel")}),c.bind("typeahead:asyncreceive",function(){b.$emit("typeahead:asyncreceive")}),c.bind("typeahead:render",function(){b.$emit("typeahead:render")}),c.bind("typeahead:cursorchanged",function(a,c,d){b.$emit("typeahead:cursorchanged",a,c,d)})}}}])});